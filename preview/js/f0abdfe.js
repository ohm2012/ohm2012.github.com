var students=[];$("#container").find(".student").each(function(){var a={};a.index=$(this).attr("data-index");a.name=$(this).attr("data-name");a.title=$(this).attr("data-title");a.portraitUrl=$(this).find(".portrait").attr("src");a.slides=[];a.active=!1;$(this).find(".sl").each(function(){a.slides.push($(this))});a.numSlides=a.slides.length;students.push(a)}).remove();
var gallery={parent:$("#absolventen"),elem:null,$slidewrapper:null,sliding:0,isOpen:!1,numSlides:0,slidePos:0,slideWidth:0,$activeSlide:null,activeStudentIndex:0,getStudentBySlide:function(a){return this.$slidewrapper.children().eq(a).prev(".first").index(".first")},getSlideByStudent:function(a){return this.$slidewrapper.find(".first").eq(a).index()},increaseStudent:function(){studentIndex+=1},init:function(){this.elem=$('<div id="gallery"></div>');this.elem.appendTo(this.parent);this.elem=$("#gallery");
this.$slidewrapper=$('<div id="slide-wrapper"></div>');this.elem.append($('<a class="prev-student" href="#">vorheriger</a><a class="next-student" href="#">n\u00e4chster</a><a class="close" href="#"><span class="visuallyhidden">x</span></a>'));this.$slidewrapper.appendTo(this.elem);for(var a=0,b=students.length;a<b;a++)for(var c=students[a],d=0,f=c.slides.length;d<f;d++){var e=c.slides[d];this.numSlides+=1;var g=e.hasClass("text")?"tablecell":"",h=d===0?"first":null;$(document.createElement("div")).addClass("slide "+
h).attr("id","student"+c.index+"-slide"+d).append($(document.createElement("div")).addClass("slide-inner").addClass(g).append(e.html())).appendTo(this.$slidewrapper)}this.$activeSlide=this.$slidewrapper.children().eq(0);this.$activeSlide.addClass("active-slide");return!0},open:function(a){var b=this;this.elem.stop().css({width:vpW-2*cBorder-gutter}).transition({height:vpH-2*gutter},500,function(){b.elem.addClass("full");$("html,body").stop().animate({scrollTop:b.elem.offset().top-gutter},500,function(){b.elem.transition({opacity:1});
$activeElement=$("#gallery");resize();b.move(a);b.isOpen=!0})})},move:function(a){var b=this;if(b.sliding===0){var c=typeof a;if(c==="string")if(a==="next")b.slidePos+=1;else if(a==="prev")b.slidePos-=1;else if(a==="last")b.slidePos=b.numSlides-1;else if(a==="first")b.slidePos=0;else{if(a!=="next-student"&&a!=="prev student")b.slidePos=0}else if(c==="number")b.slidePos=a;b.sliding=1;b.slidePos>b.numSlides-1?(b.slidePos=b.numSlides-1,$("#slide-wrapper").stop().transition({left:-b.slidePos*b.slideWidth-
100},100,"ease-in-out").transition({left:-b.slidePos*b.slideWidth},100,"ease-in-out",function(){b.sliding=0})):b.slidePos<0?(b.slidePos=0,$("#slide-wrapper").transition({left:-b.slidePos*b.slideWidth+100},100,"ease-in-out").transition({left:-b.slidePos*b.slideWidth},100,"ease-in-out",function(){b.sliding=0})):$("#slide-wrapper").transition({left:-b.slidePos*b.slideWidth},300,"ease-in-out",function(){b.sliding=0})}return!0}};gallery.init();
for(var i=0,j=students.length;i<j;i++){var stu=students[i];$(document.createElement("div")).addClass("item").append($(document.createElement("div")).addClass("item-inner").append($(document.createElement("div")).addClass("front").append($(document.createElement("div")).addClass("student-portrait").append($(document.createElement("img")).attr("src",stu.portraitUrl)))).append($(document.createElement("div")).addClass("back").append($(document.createElement("div")).addClass("student-description").append($(document.createElement("h2")).text(stu.name),
$(document.createElement("h3")).text(stu.title)),$(document.createElement("a")).attr({href:"#student"+stu.index,"data-id":stu.id}).addClass("open").append($(document.createElement("span")).addClass("visuallyhidden").text("open"))))).appendTo("#container")}var vpW=0,vpH=0,cBorder=100,margin=10,gutter=2*margin,$c=$("#container"),$body=$("body"),colnum=6,itemw=0,touch=null,swipe=0,studentId=0;$activeElement=$("#home");var animateTitle=!0;Modernizr.touch&&(touch=!0);$(window).resize(function(){resize()});
function resize(){vpW=$(window).width();vpH=$(window).height();var a=0,a=vpW<321?1:vpW<580?2:vpW<900?3:vpW<1200?4:vpW<1600?5:vpW<1700?6:vpW<2E3?7:vpW<2500?8:9;a!=colnum&&(colnum=a,cBorder=a*a);$("section").css({"min-height":vpH});vpW/vpH>1?$("#parallax").width(vpH-cBorder).height(vpH-cBorder):$("#parallax").width(vpW-cBorder).height(vpW-cBorder);itemw=(vpW-(colnum+1)*gutter-cBorder)/colnum;a=vpW-cBorder-gutter+1;$c.width(a);$(".item").width(itemw).height(itemw*4/3);$full=$(".full");$slides=$full.find(".slide");
$full.width(a).height(vpH-gutter*2);gallery.slideWidth=a;$slides.width(gallery.slideWidth).height(vpH-gutter*2);$(".slide-inner").width(gallery.slideWidth).height(vpH-gutter*2);gallery.$slidewrapper.width(gallery.slideWidth*gallery.numSlides);gallery.$slidewrapper.css({left:-gallery.slidePos*gallery.slideWidth});$("html,body").scrollTop($activeElement.offset().top-gutter);$.waypoints("refresh")}resize();$("#container").on("click",".item",function(){$(".focus").removeClass("focus");$(this).addClass("focus")});
$("#container").on("click",".focus",function(){$(this).removeClass("focus")});$("#container").on("click",".open",function(a){a.stopPropagation();a.preventDefault();a=$(this).attr("href");console.log("studenId: "+a);var b=gallery.$slidewrapper.find(a+"-slide0").index();$activeElement=$target=$("#gallery");gallery.isOpen?$("html,body").stop().animate({scrollTop:$target.offset().top-gutter},500,function(){resize();console.log("gallerie schon offen");gallery.move(b)}):gallery.open(b)});
$("#gallery").on("click",".close",function(a){a.stopPropagation();a.preventDefault();$target=$("#gallery");$target.transition({height:0,opacity:0},500,function(){$("html,body").stop().animate({scrollTop:$("#absolventen").offset().top-gutter},500,function(){$activeElement=$("#absolventen");$target.removeClass("full");resize();gallery.isOpen=!1})})});
$("#nav").find("a[href^='#']").click(function(a){a.preventDefault();$(this);a=$(this.hash);$("html, body").stop().animate({scrollTop:a.offset().top-gutter},500,"swing",function(){})});$("section").waypoint({offset:"50%"});
$("body").on("waypoint.reached","section",function(a,b){var c=$(this);b==="up"&&(c=c.prev());c.length||(c=c.end());$activeElement=c;$(".section-active").removeClass("section-active");c.addClass("section-active");$(".link-active").removeClass("link-active");$("a[href=#"+c.attr("id")+"]").addClass("link-active")});$("#gallery").mousemove(function(a){a.pageX>vpW/2?$(this).css({cursor:"e-resize"}):a.pageX<vpW/2&&$(this).css({cursor:"w-resize"})});
$("#gallery").click(function(a){a.pageX>vpW/2?gallery.move("next"):a.pageX<vpW/2&&gallery.move("prev")});$(".next-student").click(function(a){a.preventDefault();a.stopPropagation();gallery.move("next-student")});$(".prev-student").click(function(a){a.preventDefault();a.stopPropagation();gallery.move("prev-student")});$(window).hashchange(function(a){a.preventDefault()});
var layer0={element:$("#layer0"),speed:0.03,startX:64,startY:33,x:0,y:0},layer1={element:$("#layer1"),speed:0.04,startX:40,startY:30,x:0,y:0},layer2={element:$("#layer2"),speed:0.05,startX:30,startY:26,x:0,y:0},layer3={element:$("#layer3"),speed:0.06,startX:29,startY:40,x:0,y:0},layer4={element:$("#layer4"),speed:0.07,startX:38,startY:60,x:0,y:0},layer5={element:$("#layer5"),speed:0.08,startX:60,startY:63,x:0,y:0},layer6={element:$("#layer6"),speed:0.09,startX:40,startY:68,x:0,y:0},layer7={element:$("#layer7"),
speed:0.1,startX:70,startY:45,x:0,y:0},layer8={element:$("#layer8"),speed:0.02,startX:50,startY:27,x:0,y:0},layer9={element:$("#layer9"),speed:0.01,startX:50,startY:50,x:0,y:0},layer10={element:$("#layer10"),speed:0.01,startX:50,startY:88,x:0,y:0},layers=[layer0,layer1,layer2,layer3,layer4,layer5,layer6,layer7,layer8,layer9,layer10],ofY;initLayers();moveLayers();function initLayers(){for(var a=0,b=layers.length;a<b;a++)lay=layers[a],lay.x=lay.startX,lay.y=lay.startY}
function moveLayers(){for(var a=0,b=layers.length;a<b;a++)lay=layers[a],lay.element.css({left:lay.x+"%",top:lay.y+"%"})}window.requestAnimFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(a){window.setTimeout(a,1E3/60)}}();
$("#title").mouseenter(function(){animateTitle=!0;animate()}).mouseleave(function(){animateTitle=!1;for(var a=0,b=layers.length;a<b;a++)lay=layers[a],lay.x=lay.startX,lay.y=lay.startY,lay.element.stop().animate({left:lay.x+"%",top:lay.y+"%"},500,"swing")});init();animate();function init(){}function animate(){animateTitle&&(requestAnimFrame(animate),draw())}
function draw(){for(var a=(new Date).getTime()*0.0020,b=(1+Math.sin(a))*vpW/2,a=(1+Math.sin(a))*vpH/2,b=-(50-b*100/vpW),a=-(50-a*100/vpH),c=0,d=layers.length;c<d;c++)lay=layers[c],lay.x=lay.startX+lay.speed*b,lay.y=lay.startY+lay.speed*a;moveLayers()};
